<!DOCTYPE html>
<html>
  <head>
    <title>Sports Analytics with R</title>
    <meta charset="utf-8">
    <meta name="author" content="Melbourne R Ladies" />
    <meta name="date" content="2017-06-15" />
    <link href="libs/remark-css/example.css" rel="stylesheet" />
    <link rel="stylesheet" href="talk.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Sports Analytics with R
### Melbourne R Ladies
### June 15, 2017

---





# About Me

- ISEAL Research Fellow at Victoria University

- Principal Data Scientist for Tennis Australia's Game Insight Group

- Tennis Blog: [on-the-t.com](http://on-the-t.com)

- @StatsOnTheT

&lt;div align="center"&gt;
&lt;img src="gig-logo.png" width=40%&gt;
&lt;/div&gt;

---

# What It's Like to Be a Sports Statistician

.left[
- Finding sports data

- Scraping sports data

- Data wrangling

- Exploratory data analysis

- Predictive modelling

- Blogging
]

.right[
![](halep_excited.gif)
]


---

.hbox[
## Finding Sports Data
]

---

class: slide-img

# Popular Types of Sports Data

- Box Scores

- Performance Metrics

- Tracking Data

- Wearable Data

---

class: slide-img

# Box Scores

A 'box score' is a generic term for the summary statistics reported about a single sporting event.

&lt;div align="center"&gt;
&lt;img src="1876boxscore.jpg" width=60%&gt;
&lt;/div&gt;

.footnote[
[1] Baseball box score from 1876.
]

---

class: slide-img

# Performance Metrics

Performance metrics are usually repeated measures of team or players that are derived from historical box scores. 

&lt;br&gt;

&lt;div align="center"&gt;
&lt;img src="tennis-performance-metrics.png" width=80%&gt;
&lt;/div&gt;

---

class: slide-img

# Tracking Data

'Tracking data' is spatio-temporal data of objects in a sporting event.

&lt;br&gt;

&lt;div align="center"&gt;
&lt;img src="lebron.jpg" width=70%&gt;
&lt;/div&gt;


---

class: slide-img

# Wearables

.left[
- 'Wearables' are technologies that collect data about athletes when worn. 

- Biometrics and movement are two common types of data collected.
]

.right[
&lt;div align="center"&gt;
&lt;img src="afl_kick.jpg" width=80%&gt;
&lt;/div&gt;
]

---

class: slide-img

# Data Availability Curve

Sadly, not all types of sports data are equally available though the steepness of the curve depends on the particular sport.

&lt;div align="center"&gt;
&lt;img src="data_availability.png" width=70%&gt;
&lt;/div&gt;


---

class: slide-img

# Web Resources

&lt;div align="center"&gt;
&lt;img src="resources.png" width=65%&gt;
&lt;/div&gt;

---

class: slide-img

# R Resources 

<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Sport</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Package</th>
</tr>
</thead>
<tbody>
<tr style='background-color: #ffffff;'>
<td style='width: 70%;text-align:center; background-color: #ffffff; text-align: center;'>General</td>
<td style='width: 70%;text-align:center; background-color: #ffffff; text-align: center;'>stattleshipR</td>
</tr>
<tr style='background-color: #ffffff;'>
<td style='width: 70%;text-align:center; background-color: #ffffff; text-align: center;'></td>
<td style='width: 70%;text-align:center; background-color: #ffffff; text-align: center;'>SportsAnalytics</td>
</tr>
<tr style='background-color: #ffffff;'>
<td style='width: 70%;text-align:center; background-color: #ffffff; text-align: center;'></td>
<td style='width: 70%;text-align:center; background-color: #ffffff; text-align: center;'>odds.converter</td>
</tr>
<tr style='background-color: #eeeeee;'>
<td style='width: 70%;text-align:center; background-color: #eeeeee; text-align: center;'>Soccer</td>
<td style='width: 70%;text-align:center; background-color: #eeeeee; text-align: center;'>engsoccerdata</td>
</tr>
<tr style='background-color: #ffffff;'>
<td style='width: 70%;text-align:center; background-color: #ffffff; text-align: center;'>Baseball</td>
<td style='width: 70%;text-align:center; background-color: #ffffff; text-align: center;'>pitchRx</td>
</tr>
<tr style='background-color: #ffffff;'>
<td style='width: 70%;text-align:center; background-color: #ffffff; text-align: center;'></td>
<td style='width: 70%;text-align:center; background-color: #ffffff; text-align: center;'>Lahman</td>
</tr>
<tr style='background-color: #eeeeee;'>
<td style='width: 70%;text-align:center; background-color: #eeeeee; text-align: center;'>Tennis</td>
<td style='width: 70%;text-align:center; background-color: #eeeeee; text-align: center;'>deuce</td>
</tr>
<tr style='background-color: #ffffff;'>
<td style='width: 70%;text-align:center; background-color: #ffffff; border-bottom: 2px solid grey; text-align: center;'>Cricket</td>
<td style='width: 70%;text-align:center; background-color: #ffffff; border-bottom: 2px solid grey; text-align: center;'>cricketr!</td>
</tr>
</tbody>
</table>

---

# More on `deuce`

--

* `deuce` is a package I created to make it easy to access large historical data on tennis matches

--

* It combines data from multiple sites: 
  - [flashscore.com](www.flashscore.com)
  - [ATP Tour](http://atptour.com)
  - [WTA Tour](http://www.wtatennis.com)
  - [Tennis Abstract](www.tennisabstract.com)
  

--

* Some of the data you can obtain from `deuce` includes:

  - Match results from Open Era (1968) to the present

  - Historical rankings

  - Player demographics

  - Point-level data for multiple years at Grand Slams

  - Shot level data from the Match Charting Project
  
---

class: slide-img

# Installing `deuce`

You can install deuce using `devtools`. It may take several minutes because of the size of the datasets being transferred.

&lt;br&gt;


```r
library(devtools)

devtools::install_github("skoval/deuce")
```

---

class: slide-img

# Illustrative Analysis: Match Duration


```r
library(deuce)
library(dplyr)

data(atp_matches, package = "deuce")

french_minutes &lt;- atp_matches %&gt;%
  dplyr::filter(tourney_name == "Roland Garros", 
         year &gt;= 2006 &amp; year &lt; 2017)

french_minutes %&gt;%
  group_by(year) %&gt;%
  dplyr::summarise(
    total.time = sum(minutes, na.rm = T)
  ) %&gt;%
  ggplot(aes(y = total.time / 60, x = year)) + 
  geom_point(size = 2, col = "sienna") + geom_line(col = "sienna") + 
  scale_y_continuous("Total Event Hours") + 
  theme_gdocs() + 
  ggtitle("French Open Duration Trends")
```

---

![](sports-tutorial_files/figure-html/unnamed-chunk-3-1.png)&lt;!-- --&gt;

---

.hbox[
## Scraping Sports Data
]


---

class: slide-img

# Ways of Getting Sports Data

.left[
- Not always fun but a necessary part of sports analysis

- There are two major ways to get data from Web:

  1. Import a file directly

  2. Extract from HTML
] 

.right[
![](rocky_scraping.gif)
]

---

class: slide-img

# Example: Import Data File

- Files that can be read with `read.table` or related functions can be directly imported from a URL. 

- Here we extract the most recent Australian Open match results and betting odds using `read.csv`.

&lt;br&gt;


```r
url &lt;- "http://www.tennis-data.co.uk/2017/ausopen.csv"

read.csv(url)
```

---

class: slide-img

# Scraping from a Website

If you can't directly import data from the Web, you can still capture the data but you need to know whether it is *static* or *dynamic* data. 

&lt;br&gt;

--

.left[
![](cat_inspect.gif)
]

.right[
* Web data is _static_ if you can see it in the source code.

* If you can't, the data is _dynamically_ generated and you will need automation to extract it.
]

---

class: slide-img

# How Do I Know if Data is Static or Dynamic?

.left[
- You need to be able to inspect HTML and CSS

- I recommend Google Chrome's developer tools

- Get familiar with "View Source" 

- Try out the Selector Gadget
]

.right[
&lt;div align="center"&gt;
&lt;img src="under_hood.jpeg" width=150%&gt;
&lt;/div&gt;
]


---

class: slide-img

# Example: Static or Dynamic?

Look at the source code for each of the following sites and determine whether they are examples of _static_ or _dynamic_ data.

&lt;br&gt;

Case 1. [http://tennisabstract.com/reports/atp_elo_ratings.html](http://tennisabstract.com/reports/atp_elo_ratings.html)

Case 2. [http://www.espncricinfo.com/ci/content/stats/](http://www.espncricinfo.com/ci/content/stats/)


---

class: slide-img

# Scraping Static Data with `rvest`

--

- The `rvest` package is a suite of tools for scraping static Web data and putting them in easy-to-use objects (like data frames)

--

- Works with `magrittr` and allows piping commands with `%&gt;%` operator

--

- Allows some browsing functionality

--

- Authored by Hadley Wickham

---

class: slide-img

# Example: Scraping Elo Ratings


```r
library(rvest)

url &lt;- "http://tennisabstract.com/reports/atp_elo_ratings.html"

page &lt;- read_html(url)

# Use table class to extract Elo table
elo &lt;- page %&gt;%
    html_nodes("table.tablesorter") %&gt;%
    html_table()

head(elo)
```


---

class: slide-img

# Scraping Dynamic Data with `RSelenium`

.left[

- We have to automate Web browsing to get dynamic data


- _Selenium_ is software that allows automated Web browsing

- [RSelenium](https://cran.r-project.org/web/packages/RSelenium/index.html) is a package that provides Selenium functionality in R
]

.right[
&lt;div align="center"&gt;
&lt;img src="automated_browsing.gif" width=90%&gt;
&lt;/div&gt;
]


---

class: slide-img

# RSelenium: Basic Steps

1. Set the Web driver (select browser and port)

2. Find the elements with the data

3. Extract the content

4. Parse the contents

---

class: slide-img

# Example: Tennis Match Statistics

Consider the following match summary: [2017 Australian Open Final](http://www.flashscore.com/match/Cj6I5iL9/#match-statistics;0)


![](aus-open-final.png)

---


class: slide-img

# Example: Tennis Match Statistics

If we inspect the page, we find that these stats are dynamic data. We also find that the main table of content has the id `detail`.

![](aus-open-inspect.png)


---

# Using RSelenium

Below we activate the driver using a port that is not in use. 

*Note:* You may need to activate javascript in the background for this driver to work.


```r
library(RSelenium) # Load the package

# Match statistics URL
url &lt;- "http://www.flashscore.com/match/Cj6I5iL9/#match-statistics;0"

# Establish remote driver using Chrome
remDr &lt;-remoteDriver(port = 5556, browser = "chrome")
remDr$open(silent = TRUE)
remDr$navigate(url) # Navigate page
```

---

# Using RSelenium

Next we extract the table of stats using the CSS `id` node.


```r
# Get id element
webElem &lt;- remDr$findElements(using = 'id', "detail")

#  Use getElementText to extract the text from this element
unlist(lapply(webElem, function(x){x$getElementText()}))[[1]]

remDr$close() # Close driver when finished
```

---

.hbox[
## Data Wrangling
]


---

class: slide-img

# Goal of Wrangling

The purpose of _wrangling_ is to go from untidy data to a tidy row-by-column structure of our data, that has clearly named variables and valid values. 

![](tidy_goal.jpeg)

---

class: slide-img

# R's Arsenal for Wrangling

.left[
* `stringr` for string manipulation

* `tidyr` a grammar for reshaping data

* `dplyr` a grammar for filtering and transforming data
]

.right[
&lt;div align="center"&gt;
&lt;img src="tools.gif" width=85%&gt;
&lt;/div&gt;
]


---

class: slide-img

# Wrangling by Example

Consider this string of tennis match statistics scraped from the Web. How could we get this into a nice data structure?




```r
match_stats # Example of untidy data
```


![](match_stats.png)

---

# What Steps Do We Need?

1. Identify the target structure (that is, variables and value types)

2. Split the string into the different variables

3. Extract values

4. Assign to variables in a data.frame

---

# Goal Structure

We have a set of statistics for each player. One option is a long format with the following structure:


&lt;br&gt;

&lt;div align="center"&gt;
&lt;img src="match_stats_table.png" width=60%&gt;
&lt;/div&gt;


---

# Splitting


```r
library(stringr) # Load stingr

str_split(match_stats, "\n") # Split on return characters
```

```
## [[1]]
##  [1] "ALEXANDER"                   "ZVEREV"                     
##  [3] "NOVAK"                       "DJOKOVIC"                   
##  [5] "MATCH STATS YTD STATS"       "SERVICE STATS"              
##  [7] "7"                           "Aces"                       
##  [9] "1"                           "2"                          
## [11] "Double Faults"               "3"                          
## [13] "71%"                         "(32/45)"                    
## [15] "1st Serve"                   "64%"                        
## [17] "(43/67)"                     "84%"                        
## [19] "(27/32)"                     "1st Serve Points Won"       
## [21] "70%"                         "(30/43)"                    
## [23] "69%"                         "(9/13)"                     
## [25] "2nd Serve Points Won"        "38%"                        
## [27] "(9/24)"                      "0%"                         
## [29] "(0/0)"                       "Break Points Saved"         
## [31] "40%"                         "(2/5)"                      
## [33] "9"                           "Service Games Played"       
## [35] "10"                          "RETURN STATS"               
## [37] "30%"                         "(13/43)"                    
## [39] "1st Serve Return Points Won" "16%"                        
## [41] "(5/32)"                      "63%"                        
## [43] "(15/24)"                     "2nd Serve Return Points Won"
## [45] "31%"                         "(4/13)"                     
## [47] "60%"                         "(3/5)"                      
## [49] "Break Points Converted"      "0%"                         
## [51] "(0/0)"                       "10"                         
## [53] "Return Games Played"         "9"                          
## [55] "POINTS STATS"                "80%"                        
## [57] "(36/45)"                     "Return Points Won"          
## [59] "58%"                         "(39/67)"                    
## [61] "42%"                         "(28/67)"                    
## [63] "Total Return Points Won"     "20%"                        
## [65] "(9/45)"                      "57%"                        
## [67] "(64/112)"                    "Total Points Won"           
## [69] "43%"                         "(48/112)"
```

---

# Group Data by Pattern

- Now that we have isolated some of the main elements of our data as a vector, we want to group data by type. 

- We can use pattern-matching to separate strings by their pattern combining `stringr` and regular expressions.

- Here, we can separate the stats by using a pattern that finds elements with at least one lower-case letter

&lt;br&gt;


```r
split &lt;- str_split(match_stats, "\n")[[1]] # Save split vector

pattern &lt;- "[a-z]"

stats &lt;- str_subset(split, pattern) # Subset players and stat names
```

---

# Using RegEx to Sort Data

We use exclusion to get all the other values


```r
values &lt;- split[
	!str_detect(split, pattern) &amp;
	!str_detect(split, "[A-Z]")
 ] # Get values
```

---

# Structuring Data Frame

We notice that some stats have just counts while others have percentages and ratios. We can deal with this by flagging counts and expanding the data frame based on the condition of being a count or percentage stat.


```r
counts &lt;- stats %in% c("Aces", 
		"Double Faults", 
		"Service Games Played", 
		"Return Games Played")

result &lt;- data.frame(
	stat = rep(stats, ifelse(counts, 2, 4)),
	values = values
)

result
```

```
##                           stat   values
## 1                         Aces        7
## 2                         Aces        1
## 3                Double Faults        2
## 4                Double Faults        3
## 5                    1st Serve      71%
## 6                    1st Serve  (32/45)
## 7                    1st Serve      64%
## 8                    1st Serve  (43/67)
## 9         1st Serve Points Won      84%
## 10        1st Serve Points Won  (27/32)
## 11        1st Serve Points Won      70%
## 12        1st Serve Points Won  (30/43)
## 13        2nd Serve Points Won      69%
## 14        2nd Serve Points Won   (9/13)
## 15        2nd Serve Points Won      38%
## 16        2nd Serve Points Won   (9/24)
## 17          Break Points Saved       0%
## 18          Break Points Saved    (0/0)
## 19          Break Points Saved      40%
## 20          Break Points Saved    (2/5)
## 21        Service Games Played        9
## 22        Service Games Played       10
## 23 1st Serve Return Points Won      30%
## 24 1st Serve Return Points Won  (13/43)
## 25 1st Serve Return Points Won      16%
## 26 1st Serve Return Points Won   (5/32)
## 27 2nd Serve Return Points Won      63%
## 28 2nd Serve Return Points Won  (15/24)
## 29 2nd Serve Return Points Won      31%
## 30 2nd Serve Return Points Won   (4/13)
## 31      Break Points Converted      60%
## 32      Break Points Converted    (3/5)
## 33      Break Points Converted       0%
## 34      Break Points Converted    (0/0)
## 35         Return Games Played       10
## 36         Return Games Played        9
## 37           Return Points Won      80%
## 38           Return Points Won  (36/45)
## 39           Return Points Won      58%
## 40           Return Points Won  (39/67)
## 41     Total Return Points Won      42%
## 42     Total Return Points Won  (28/67)
## 43     Total Return Points Won      20%
## 44     Total Return Points Won   (9/45)
## 45            Total Points Won      57%
## 46            Total Points Won (64/112)
## 47            Total Points Won      43%
## 48            Total Points Won (48/112)
```

---

# String Substitution

We will need to do some more tidying of the strings to get our `value` column into numeric values. String replace will be a big help. Here are some examples of removing percentage signs and parentheses using `str_replace`.


```r
# We use 'all' to replace all instances
# The escapes \\ make sure () are treated as fixed
str_replace_all(values,"[\\(%\\)]", "")
```

```
##  [1] "7"      "1"      "2"      "3"      "71"     "32/45"  "64"    
##  [8] "43/67"  "84"     "27/32"  "70"     "30/43"  "69"     "9/13"  
## [15] "38"     "9/24"   "0"      "0/0"    "40"     "2/5"    "9"     
## [22] "10"     "30"     "13/43"  "16"     "5/32"   "63"     "15/24" 
## [29] "31"     "4/13"   "60"     "3/5"    "0"      "0/0"    "10"    
## [36] "9"      "80"     "36/45"  "58"     "39/67"  "42"     "28/67" 
## [43] "20"     "9/45"   "57"     "64/112" "43"     "48/112"
```

---

class:slide-img

# Reshaping a Data Frame

We frequently need to go between wide and long formats of our data. With `tidyr` we can use `gather` to go from wide to long and `spread` to go from long to wide.

Below is an example of reshaping our `match_stats` going from long to wide. 


```r
library(tidyr)

# Assign player to their stat
result &lt;- result %&gt;%
    group_by(stat) %&gt;%
    dplyr::mutate(
      player = rep(c(1, 2), each = n() / 2)
    )

result %&gt;%
  filter(stat %in% c("Aces", "Double Faults")) %&gt;%
  tidyr::spread(stat, values)
```

---


```
## # A tibble: 2 × 3
##   player   Aces `Double Faults`
## *  &lt;dbl&gt; &lt;fctr&gt;          &lt;fctr&gt;
## 1      1      7               2
## 2      2      1               3
```

---

.hbox[
## Exploring Our Data
]


---

class: slide-img

# Data Exploration

.hbox[
_Exploratory data analysis is detective work-numerical detective work-or counting detective work-or graphical detective work...Exploratory data analysis can never be the whole story, but nothing else can serve as the foundation stone--as the first step._ - John Tukey
]

---

# EDA Starts By Asking Questions

.left[
- All exploration needs some direction

- Exploring aimlessly wastes time and rarely will get you where you need to be

- To avoid aimless exploration, you need to ask yourself what you are looking for? and what would be interesting to find?

- This means getting to know your variables with summary functions like: `str`, `table`, and `summary`
]

.right[
![](successcompass.jpg)
]


---

# Exploratory Charting

--

* Most of our describing and exploration in `R` happens with graphics

--

* A powerful package for graphing is `ggplot2`

--

* `ggplot2` provides a grammar for building univariate, bivariate, and lattice plots

--

* Also, many specialty graphics packages build on `ggplot2`

---

# Overview of `ggplot2`

To install, use `install.packages('ggplot2')`.

<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Function.Type</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; text-align: left;'>aes</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; text-align: left;'>Relates variables to axes and aesthetic elements of our plot</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; background-color: #f7f7f7; text-align: left;'>geoms</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; background-color: #f7f7f7; text-align: left;'>Define how the variables will be displayed, that is, the type of chart</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; text-align: left;'>facet</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; text-align: left;'>Splits plot into rows and columns defined by a group variable</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; background-color: #f7f7f7; text-align: left;'>scales</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; background-color: #f7f7f7; text-align: left;'>Customizes the range and limits of aesthetics</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; border-bottom: 2px solid grey; text-align: left;'>themes</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; border-bottom: 2px solid grey; text-align: left;'>Further controls of the style and elements of the chart</td>
</tr>
</tbody>
</table>

---

class:slide-img

# Example: Match Duration Trends by Surface

In this example, we explore patterns in match duration by surface using a number of features in `ggplot2` and `ggthemes`.




```r
data(atp_matches)
```


```r
atp_matches %&gt;%
  filter(!(minutes == 0 | minutes &gt; 10 * 60), surface != "Carpet") %&gt;%
	ggplot(aes(y = minutes, x = tourney_date, 
	           col = surface, fill = surface)) +
  facet_grid(surface ~ .) + # Facet by row with no column facet
  geom_smooth() + 
	geom_point(size = 2) + 
  scale_color_tableau(name = "") + 
  scale_fill_manual(name = "", 
                    values = alpha(tableau_color_pal()(3), 0.5)) + 
  scale_x_date("Event Week", date_breaks = "3 week") +
	theme_bw() + 
  theme(axis.text.x = element_text(angle = 90))
```

---

![](sports-tutorial_files/figure-html/unnamed-chunk-19-1.png)&lt;!-- --&gt;

---

class:slide-img

# 3D Charting

* So far, we have only considered two-dimensional charts.

* For 3D data, we can use the package `plot3D`.

* But first, we need to extract the (x, y, z) coordinates for each serve along a set of time points.



---

class: slide-img

# Plotting Tennis Shots

In this example, we will look at some tracking data for about 60 tennis serves of ATP players. The data includes the x, y, and z locations of the flight of the serves.


```r
positions[1:10,] # Serve position data
```

```
##     seconds         x         y        z id
## 1  1.532434 -11.39293 0.7152673 3.089983  1
## 2  1.532823 -11.36955 0.7105796 3.086929  1
## 3  1.533213 -11.34617 0.7058936 3.083875  1
## 4  1.533602 -11.32280 0.7012094 3.080821  1
## 5  1.533991 -11.29944 0.6965270 3.077767  1
## 6  1.534381 -11.27608 0.6918463 3.074713  1
## 7  1.534770 -11.25274 0.6871674 3.071659  1
## 8  1.535159 -11.22940 0.6824902 3.068605  1
## 9  1.535549 -11.20607 0.6778148 3.065551  1
## 10 1.535938 -11.18275 0.6731411 3.062497  1
```

---

class: slide-img

# Package `plot3D`

* The `plot3D` package provides a suite a functions for 3D plots: `points3D`, `lines3D`, `ribbon3D`, etc. 

* You can install with `install.packages('plot3D')`


---

# Plot3D Key Arguments

In addition to the basic variables `x`, `y`, `z`, here are some useful arguments when working with `plot3D`.

<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Argument</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>colvar</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>Numeric group variable for coloring points</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>phi</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>Angle defining colatitude</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>theta</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>Angle defining azimuthal direction</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>col</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>Colors to use with colvar</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; border-bottom: 2px solid grey; text-align: left;'>bty</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; border-bottom: 2px solid grey; text-align: left;'>Style for the perspective box</td>
</tr>
</tbody>
</table>

---

# Plotting Serves

In this chart, we plot all serves using the `points3D`. We set `theta` to 0 so that we look perpendicularly along the length of the court.


```r
library(plot3D) # Load plot3D

points3D(
	x = positions$x,
	y = positions$y,
	z = positions$z,
	colvar = positions$id,
	theta = 0
)
```

---

![](sports-tutorial_files/figure-html/unnamed-chunk-23-1.png)&lt;!-- --&gt;

---

.hbox[
## Prediction Models
]

---

class: slide-img

# Sport Prediction


.left[
![](crystal_ball.gif)
]

.right[
### Predicting _who will win_ is the holy grail of sports analytics and is a major research area of interest for sports statisticians.
]


---

# Descriptive vs Predictive Models

--

*  _Predictive modeling_ usually refers to machine learning  

--

* The goal of these techniques is to improve predictive performance

--

* This is a very different goal from statistical models, like regression, where inference and interpretation are of primary importance

--

* Predictive models will often sacrifice interpretability for improved performance


---

# Describe Before You Predict

* Because it is often a challenge to interpret the "how" of machine learning methods, it is good practice to first do some statistical modelling (e.g. `glm(y ~ x + ...)`)

* The reasons for this include:

  - Getting familiar with the interrelationships in your data 
  
  - Identifying any issues not flagged during EDA
  
  - Developing some expectations for the predictive modelling results


---

# Predictive Modelling with `caret`

.left[
* Once you are ready to develop your prediction model, the `caret` package, written by Max Kuhn, is a great resource for machine learning in `R`

* `caret` stand for Classification And REgression Training 

* It includes 100+ predictive modelling methods

* It provides a unified &amp; streamlines interface for building and evaluating models

* It allows parallel processing for faster computation

* You can install with `install.packages('caret')`
]

.right[
&lt;div align="center"&gt;
&lt;img src="applied_caret.jpg" width=80%&gt;
&lt;/div&gt;
]

---

# Modelling Steps

--

Step 1. Decide how to spend your data

--

Step 2. Split the data into training and test

--

Step 3. Conduct pre-processing (as needed)

--

Step 4. Train the model with resampling

--

Step 5. Evaluate the model with test data

---


# Why Split Up the Data at All?

- Testing our data on independent samples is the strongest form of validation and evaluation

- If we trained and tested on the same data, we risk _overfitting_ which is the machine-learning equivalent to a "Monday morning quarterback"

- We also resample among training for additional protection against overfitting

![](armchair-quarterback.jpg)

---

# Using `createDataPartition`

We can use `createDataPartition` to split our data:


```r
createDataPartition(y, times, p, list, ...)
```

&lt;br&gt;

<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Argument</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>y</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>Outcome vector to balance sampling on</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>times</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>Number of partitions</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>p</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>Proportion of each partition allocated to training</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;'>list</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;'>Logical whether list is returned</td>
</tr>
</tbody>
</table>

*Note:* Using 70% of our data for training is typical

---

# Example: Partitioning Data

In this example, we create one partition with 70% of our dataset allocated to training.




```r
library(caret) # Load caret

# Returns matrix of indices for obs in training
train &lt;- createDataPartition(
  y = data$outcome,
  times = 1,
  p = 0.7,
  list = F
)
```

---

# Pre-Processing

.cbox[
Before we split our data, we need to pre-process our data. The pre-processing can protect against some loss in model accuracy due to scale, skew, or high correlation.
]

&lt;br&gt;

Common pre-processing steps are:

1. Centering - Give all variables a common mean of 0

2. Standardizing - Give all variables a common scale

3. Remove highly correlated variables

4. Reduce dimension (when `\(n \sim p\)`)

---

# The `train` Function

The main workhouse function for model training in `caret` is `train`. Here are the main arguments you need to know to get started.

<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Argument</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>form</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>Formula (y ~ x)</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>data</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>Data frame of training data</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>method</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>Character of the ML method to be used</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>metric</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>Performance metric for summarizing</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>tuneLength</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>Sets granularity for tuning parameter if tuneGrid not specified</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>trControl</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>Control parameters for training</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; border-bottom: 2px solid grey; text-align: left;'>tuneGrid</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; border-bottom: 2px solid grey; text-align: left;'>Data frame that gives explicit range for tuning parameters</td>
</tr>
</tbody>
</table>

---

# Training Control

* The `trControl` argument is a list that controls a number of aspects of training including resampling and how we summarise performance with each resample.

* The resampling is an important additional measure to protect against overfitting when training 


&lt;div align="center"&gt;
&lt;img src="resampling.png" width=75%&gt;
&lt;/div&gt;


---

# Example: Using `trControl`

In our example, we will use `trControl` to use 5-fold cross validation and a two-class summary for our performance measures.


```r
ctrlSpecs &lt;- trainControl(
	method = "repeatedCV",
	repeats = 5,
	summaryFunction = twoClassSummary, # function from caret
	classProbs = TRUE # Needed to use twoClassSummary
)
```


---

# Grid Tuning

* The `tuneGrid` is a way to give a specific grid for the tuning parameters of the method

* You can use `expand.grid` to make a range of parameters

* To determine the parameters to tune and their variable names you can use `getModelInfo`

---

# Using `getModelInfo`

* We can get a model of interest with `getModelInfo('model')` or get info from all models with `getModelInfo()`.

* This returns a list per model with information about the model type, parameters, grid function, etc.

* Here is an example with the `rpart` model.


```r
getModelInfo('rpart')[['rpart']][1:4]
```

```
## $label
## [1] "CART"
## 
## $library
## [1] "rpart"
## 
## $type
## [1] "Regression"     "Classification"
## 
## $parameters
##   parameter   class                label
## 1        cp numeric Complexity Parameter
```

---

# Performance Metrics

* We can use the `metric` argument to choose our performance metric for training evaluation

* There are many metrics for evaluating classification. In general, it is best to choose one when choosing among model approaches

<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Metric</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; text-align: left;'>Accuracy</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; text-align: left;'>Proportion of exactly correct classifications</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; background-color: #f7f7f7; text-align: left;'>AUC</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; background-color: #f7f7f7; text-align: left;'>Area under the ROC curve</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; text-align: left;'>Sensitivity</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; text-align: left;'>The true positive rate (also called 'recall')</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; background-color: #f7f7f7; text-align: left;'>Specificity</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; background-color: #f7f7f7; text-align: left;'>The true negative rate</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; border-bottom: 2px solid grey; text-align: left;'>LogLoss</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%;width:40%; border-bottom: 2px solid grey; text-align: left;'>Prediction-weighted loss function</td>
</tr>
</tbody>
</table>

---

# Setting Performance Metric

There is no one correct performance measure. In fact, multiple should be evaluated when testing. For training, the "log loss" is good all around measure. Here is how we can set our control specs to use it.


```r
ctrlSpecs &lt;- trainControl(
	method = "repeatedCV",
	repeats = 5,
	summaryFunction = mnLogLoss,
	classProbs = TRUE
)
```

---

# Models

There are more than 100 models to try in `caret`! Below is just a sample of some popular kinds. The full list is available with the online [caret book](http://topepo.github.io/caret/available-models.html). 

<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Category</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Description</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>Forest</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>Ensemble of multiple decision trees with bagging (boostrap aggregation)</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; text-align: left;'>rf, rfRules, cforest</td>
</tr>
<tr style='background-color: #f7f7f7;'>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>Boosted</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>Incremental building of multiple classifiers, which is a kind of correlated ensembling</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; background-color: #f7f7f7; text-align: left;'>gbm, adaboost, C5.0</td>
</tr>
<tr>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; border-bottom: 2px solid grey; text-align: left;'>Support Vector Machines</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; border-bottom: 2px solid grey; text-align: left;'>Collection of regression lines that try to maximally separate classes</td>
<td style='padding-left: 5%; padding-right:0%; padding-top: 2%;padding-bottom: 2%; border-bottom: 2px solid grey; text-align: left;'>svmLinear, svmRadial</td>
</tr>
</tbody>
</table>

---

# Random Forest

Let's have a look at each category and how we could train each in `caret`. Below we use the `rf` method to fit a random forest. The `tuneLength` is set to 10 to have a randomly generated grid for the forest parameters.


```r
set.seed(1115)

rfFit &lt;- train(
	outcome ~ .,
	data = trainingData,
	method = "rf",
	tuneLength = 10,
	trControl = ctrlSpecs,
	metric = "logLoss"
)
```

---

# Evaluate the Model

* We can see the results across the different tuning parameters using: `print` or `plot`

* The selected model can be extracted with `finalModel` and it will have all the class properties of the source method


```r
library(randomForest) # Class methods for RF

importance(rfFit$finalModel) # Variable importance
```

---

# Application: Emotion Detection

At GIG we have recently been using caret to create prediction models for player emotions based on Facial Action Units in match broadcasts.



.left[
**How much does this expression indicate:**

  - Anxiety?
  
  - Determination?
  
  - Excitement?
]

.right[
![](/Users/skovalchik/Project/FaceAU/Matches/AO2017/sample/2017_RLA_R06_RFederer_SUI_vs_SWawrinka_SUI_MS601_214_det_0.bmp)
]

---

.hbox[
## Blogging
]

---

class: slide-img

# Why Blog?

Sharing your ideas with the world is one of the most joyful parts of sports analysis.

&lt;div align="center"&gt;
&lt;img src="serena-joy.gif" width=100%&gt;
&lt;/div&gt;


---


class: slide-img

# 'On The T' Powered By Blogdown

[on-the-t.com](http://on-the-t.com/)

![](on-the-t.png)

---


# Getting There

.left[
- Starting a blog might seem overwhelming but, if you know `R` and some basic CSS, it's easy


- Producing interesting content is the tough part about blogging


- `R` helps to let you focus on _content_ by providing easy-to-use tools that solve the technical details of going from code to the Web 

- _If you can write R markdown, you can create a blog!_
]

.right[
&lt;div align="center"&gt;
&lt;img src="harry_potter.gif" width=90%&gt;
&lt;/div&gt;
]

---

# Blogdown

--

* Package for writing a blog in R 

--

* Create content with R markdown

--

* Generate site with `Hugo`, a static site generator

--

* Deploy on Github, Netlify, or other hosting services

--

* Authored by Yihui Xie (who is at the conference!)


---

# Getting Started

Here are the major functions you will use with `blogdown`.

<table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Function</th>
<th style='border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;'>Description</th>
</tr>
</thead>
<tbody>
<tr style='background-color: #ffffff;'>
<td style='padding:2%; background-color: #ffffff; text-align: left;'>install_hugo</td>
<td style='padding:2%; background-color: #ffffff; text-align: left;'>Downloads and installs Hugo</td>
</tr>
<tr style='background-color: #eeeeee;'>
<td style='padding:2%; background-color: #eeeeee; text-align: left;'>install_theme</td>
<td style='padding:2%; background-color: #eeeeee; text-align: left;'>Downloads a Hugo theme from github</td>
</tr>
<tr style='background-color: #ffffff;'>
<td style='padding:2%; background-color: #ffffff; text-align: left;'>build_site</td>
<td style='padding:2%; background-color: #ffffff; text-align: left;'>Compiles Rmd files and builds the site</td>
</tr>
<tr style='background-color: #eeeeee;'>
<td style='padding:2%; background-color: #eeeeee; text-align: left;'>html_page</td>
<td style='padding:2%; background-color: #eeeeee; text-align: left;'>Renders an Rmd file as an HTML that can be read by Hugo</td>
</tr>
<tr style='background-color: #ffffff;'>
<td style='padding:2%; background-color: #ffffff; text-align: left;'>hugo_cmd</td>
<td style='padding:2%; background-color: #ffffff; text-align: left;'>Run Hugo commands</td>
</tr>
<tr style='background-color: #eeeeee;'>
<td style='padding:2%; background-color: #eeeeee; text-align: left;'>new_content</td>
<td style='padding:2%; background-color: #eeeeee; text-align: left;'>Creates new file in working directory</td>
</tr>
<tr style='background-color: #ffffff;'>
<td style='padding:2%; background-color: #ffffff; text-align: left;'>new_site</td>
<td style='padding:2%; background-color: #ffffff; text-align: left;'>Creates enviroment for new site</td>
</tr>
<tr style='background-color: #eeeeee;'>
<td style='padding:2%; background-color: #eeeeee; border-bottom: 2px solid grey; text-align: left;'>serve_site</td>
<td style='padding:2%; background-color: #eeeeee; border-bottom: 2px solid grey; text-align: left;'>Preview working version of your site</td>
</tr>
</tbody>
</table>


---

# Learning the Workflow

Yihui and Amber Thomas have a draft manual for using blogdown that will [get you started](https://bookdown.org/yihui/blogdown/).

![](blogdown.png)

---

# Worklow Overview

1. Install `blogdown` and run `install_hugo`

2. Use `new_site` to create your site directory

3. Setup your directory with `git` and push to `github`

4. Choose your own theme choosing from [themes.gohugo.io](http://themes.gohugo.io/) and use `install_theme`

5. Configure your site by modifying `config` file

6. Create new pages with `new_post`

7. _Deploy!_

---

# Adding Interactive Graphics

.left[
- All sports blogs should use charts! And you can make your blog charts especially interesting by making them interactive.

- For `R` users who already masters of `ggplot2`, the `plotly` package is a flexible and fast way to create interactive Web graphics
]

.right[
&lt;div&gt;
    &lt;a href="https://plot.ly/~on-the-t/1221/?share_key=ZjcORFd1wz33fmAeDoXSNe" target="_blank" title="women_2017_french_open_seeds" style="display: block; text-align: center;"&gt;&lt;img src="https://plot.ly/~on-the-t/1221.png?share_key=ZjcORFd1wz33fmAeDoXSNe" alt="women_2017_french_open_seeds" style="max-width: 100%;width: 700px;"  width="400" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /&gt;&lt;/a&gt;
    &lt;script data-plotly="on-the-t:1221" sharekey-plotly="ZjcORFd1wz33fmAeDoXSNe" src="https://plot.ly/embed.js" async&gt;&lt;/script&gt;
&lt;/div&gt;

]

---

# Plotly

.hbox[
&lt;p style="font-size:24px;"&gt;Plotly is a free online service for creating and sharing Web graphics. With the `plotly` package (by Carson Sievert) you can transform `ggplots` to interactive charts on plotly.&lt;/p&gt;
]


---

# Getting Started with Plotly

Here are the basic steps to follow:


```r
install.packages(plotly)

library(plotly)

# After creating a plotly account
Sys.setenv("plotly_username"="your_plotly_username") 
Sys.setenv("plotly_api_key"="your_api_key")

&lt;CREATE GGPLOT&gt;
  
plotly_POST(gg1, filename = "my-new-plot") # Publish
```


---

# Plotly Site

Further customization can be done on the plotly site.

![](plotly-example.png)

---

# Plotly Embed

Under the `Share` link you can also find the code that you can use to embed your final plot in your R Markdown file.

![](plotly-embed.png)

---

class: slide-img

# Summary

.left[
* Doing sports analytics requires a lot of skills

* Many tools in `R` can make capturing, cleaning, and analyzing data much easier

* I hope much of what you have seen in this presentation will help you make your ideas about sports data into a reality 
]

.right[
&lt;div align="center"&gt;
&lt;img src="rafa_grit.gif" width=90%&gt;
&lt;/div&gt;
]

---


class: center

&lt;br&gt;

![](end_slide.jpeg)
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
